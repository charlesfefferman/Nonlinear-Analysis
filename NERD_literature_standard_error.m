clear

% NERD literature

NC = zeros(1,12);
T = zeros(5,12);
pv = zeros(5,12);
pL = zeros(5,12);
sv = zeros(5,12);
sL = zeros(5,12);

i = 1;
% C2

NC(i) = 2;

T(:,i) = [175.4 213.8 252.2 271 280.8];
pv(:,i) = [0.005 0.009 0.023 0.041 0.049];
pL(:,i) = [0.543 0.496 0.438 0.405 0.381];
sv(:,i) = [0.001 0.001 0.002 0.002 0.003];
sL(:,i) = [0.004 0.003 0.004 0.005 0.007];

i=i+1;
% C3

NC(i) = 3;

T(:,i) = [250 281 312 340 344];
pv(:,i) = [0.005 0.012 0.027 0.055 0.058];
pL(:,i) = [0.546 0.516 0.474 0.428 0.418];
sv(:,i) = [0.001 0.002 0.003 0.003 0.004];
sL(:,i) = [0.006 0.005 0.007 0.007 0.01];

i=i+1;
% C4

NC(i) = 4;

T(:,i) = [295 327 360 380 392];
pv(:,i) = [0.005 0.014 0.024 0.040 0.051];
pL(:,i) = [0.566 0.533 0.487 0.460 0.438];
sv(:,i) = [0.001 0.002 0.004 0.003 0.005];
sL(:,i) = [0.004 0.006 0.008 0.007 0.01];

i=i+1;
% C5

NC(i) = 5;

T(:,i) = [0 336 372 402 439];
pv(:,i) = [0 0.006 0.013 0.023 0.055];
pL(:,i) = [0 0.568 0.528 0.487 0.433];
sv(:,i) = [0 0.002 0.002 0.003 0.004];
sL(:,i) = [0 0.003 0.004 0.006 0.006];

i=i+1;
% C6

NC(i) = 6;

T(:,i) = [370 400 430 450 470];
pv(:,i) = [0.0065 0.013 0.023 0.037 0.051];
pL(:,i) = [0.577 0.546 0.506 0.480 0.439];
sv(:,i) = [0.0005 0.001 0.003 0.003 0.006];
sL(:,i) = [0.006 0.008 0.005 0.009 0.011];

i=i+1;
% C8

NC(i) = 8;

T(:,i) = [0 400 440 490 540];
pv(:,i) = [0 0.003 0.009 0.026 0.063];
pL(:,i) = [0 0.61 0.567 0.508 0.424];
sv(:,i) = [0 0.001 0.001 0.004 0.004];
sL(:,i) = [0 0.003 0.006 0.005 0.008];

i=i+1;
% C10

NC(i) = 10;

T(:,i) = [450 480 520 565 580];
pv(:,i) = [0.005 0.011 0.023 0.050 0.060];
pL(:,i) = [0.602 0.570 0.525 0.469 0.439];
sv(:,i) = [0.002 0.002 0.003 0.006 0.007];
sL(:,i) = [0.005 0.006 0.005 0.005 0.007];

i=i+1;
% C12

NC(i) = 12;

T(:,i) = [525 550 575 600 625];
pv(:,i) = [0.009 0.013 0.023 0.034 0.053];
pL(:,i) = [0.558 0.532 0.5 0.461 0.415];
sv(:,i) = [0.001 0.002 0.003 0.004 0.005];
sL(:,i) = [0.004 0.004 0.006 0.009 0.012];

i=i+1;
% C16 remember this isn't the best data b/c I had to steal it from graph
% In this file I actually used data thief

NC(i) = 16;

T(:,i) = [523.6254 600.3365 655.5779 675.3594 681.9544];
pv(:,i) = [0.0028 0.0154 0.0415 0.0502 0.0575];
pL(:,i) = [0.608 0.5394 0.4623 0.4267 0.4163];
sv(:,i) = [0.001 0.002 0.002 0.003 0.005]; % Guesses (irrelevant for this sheet)
sL(:,i) = [0.004 0.004 0.006 0.006 0.008]; 

i=i+1;
% C24

NC(i) = 24;

T(:,i) = [0 651.3 701.5 746.6 770];
pv(:,i) = [0 0.006 0.017 0.032 0.048];
pL(:,i) = [0 0.544 0.492 0.428 0.385];
sv(:,i) = [0 0.002 0.002 0.004 0.005];
sL(:,i) = [0 0.005 0.005 0.007 0.009];

i=i+1;
% C36

NC(i) = 36;

T(:,i) = [0 735 760 790 820];
pv(:,i) = [0 0.007 0.010 0.017 0.024];
pL(:,i) = [0 0.520 0.484 0.440 0.378];
sv(:,i) = [0 0.001 0.002 0.003 0.005];
sL(:,i) = [0 0.007 0.006 0.009 0.009];

i=i+1;
% C48

NC(i) = 48;

T(:,i) = [780 810 840 860 870];
pv(:,i) = [0.004 0.007 0.012 0.015 0.018];
pL(:,i) = [0.538 0.490 0.442 0.404 0.382];
sL(:,i) = [0.006 0.006 0.005 0.012 0.009];
sv(:,i) = [0.002 0.002 0.003 0.004 0.003];

for j=1:i

    if T(1,j) == 0
        
    T_j = T(2:5,j);
    pv_j = pv(2:5,j);
    pL_j = pL(2:5,j);
    sv_j = sv(2:5,j);
    sL_j = sL(2:5,j);
    
    else
        
    T_j = T(:,j);
    pv_j = pv(:,j);
    pL_j = pL(:,j);
    sv_j = sv(:,j);
    sL_j = sL(:,j);
        
    end

[TC(j),pc(j),A,b,TC_low(j),TC_high(j),pc_low(j),pc_high(j)] = towhee_rectilinear(T_j,pv_j,pL_j,sv_j,sL_j);  
    
MW = 12.0107*NC(j)+1.00794*(2*NC(j)+2);

VC_high(j) = MW/pc_low(j);
VC(j) = MW/pc(j);
VC_low(j) = MW/pc_high(j);

subplot(2,1,1)
hold
scatter(NC(j),VC(j))
plot([NC(j),NC(j)],[VC_low(j),VC_high(j)],'--')
hold

subplot(2,1,2)
hold
scatter(NC(j),TC(j))
plot([NC(j),NC(j)],[TC_low(j),TC_high(j)],'--')
hold

end

plot_NC = 5:48;

% As found in literature
VC_Tso = 3.5831*(-59.72+20.01*(plot_NC+1)+149.7./(plot_NC+1));
TC_Tso = 0.11875./(0.0001107+0.0009485./(plot_NC+1)-0.0005863./((plot_NC+1).^2));

VC_Teja = 61.7193 + 38.3386*(plot_NC).^1.16536;
TC_Teja = 1143.8 - exp(7.15908 - 0.303158*plot_NC.^0.469609);

subplot(2,1,1)
hold
plot(plot_NC,VC_Tso,'g')
plot(plot_NC,VC_Teja,'r')
hold

subplot(2,1,2)
hold
plot(plot_NC,TC_Tso,'g')
plot(plot_NC,TC_Teja,'r')
hold

